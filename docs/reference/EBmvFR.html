<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Empirical Bayes multivariate functional regression — EBmvFR • fsusieR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Bayes multivariate functional regression — EBmvFR"><meta property="og:description" content="Empirical Bayes multivariate functional regression"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fsusieR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/susiF.alpha" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical Bayes multivariate functional regression</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/fsusieR/blob/HEAD/R/EBmvFR.R" class="external-link"><code>R/EBmvFR.R</code></a></small>
    <div class="hidden name"><code>EBmvFR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Empirical Bayes multivariate functional regression</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EBmvFR</span><span class="op">(</span></span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  adjust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"mixture_normal_per_scale"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  init_pi0_w <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">nullweight</span>,</span>
<span>  control_mixsqp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span>, eps <span class="op">=</span> <span class="fl">1e-06</span>, numiter.em <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  thresh_lowcount <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cal_obj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quantile_trans <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gridmult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  max_step_EM <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_SNP_EM <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>functional phenotype, matrix of size N by size J. The
underlying algorithm uses wavelet, which assumes that J is of the
form J^2. If J is not a power of 2, susiF internally remaps the data
into a grid of length 2^J</p></dd>


<dt>X</dt>
<dd><p>matrix of size n by p contains the covariates</p></dd>


<dt>adjust</dt>
<dd><p>logical if set to TRUE (default FALSE), then the output contains the adjusted coeficients (usefull to correct for batch effect)</p></dd>


<dt>pos</dt>
<dd><p>vector of length J, corresponding to position/time pf
the observed column in Y, if missing, suppose that the observation
are evenly spaced</p></dd>


<dt>prior</dt>
<dd><p>specify the prior used in susiF. The two available choices are
available "mixture_normal_per_scale", "mixture_normal". Default "mixture_normal_per_scale",</p></dd>


<dt>verbose</dt>
<dd><p>If <code>verbose = TRUE</code>, the algorithm's progress,
and a summary of the optimization settings are printed to the
console.</p></dd>


<dt>maxit</dt>
<dd><p>Maximum number of IBSS iterations.</p></dd>


<dt>tol</dt>
<dd><p>a small, non-negative number specifying the convergence
tolerance for the IBSS fitting procedure. The fitting procedure
will halt when the difference in the variational lower bound, or
“ELBO” (the objective function to be maximized), is less
than <code>tol</code>.</p></dd>


<dt>init_pi0_w</dt>
<dd><p>starting value of weight on null compoenent in mixsqp
(between 0 and 1)</p></dd>


<dt>nullweight</dt>
<dd><p>numeric value for penalizing likelihood at point mass 0
(usefull in small sample size)</p></dd>


<dt>control_mixsqp</dt>
<dd><p>list of parameter for mixsqp function see  mixsqp package</p></dd>


<dt>thresh_lowcount</dt>
<dd><p>numeric, used to check the wavelet coefficients have
problematic distribution (very low dispersion even after standardization).
Basically check if the median of the absolute value of the distribution of
 a wavelet coefficient is below this threshold. If yes, the algorithm discard
 this wavelet coefficient (setting its estimate effect to 0 and estimate sd to 1).
 Set to 0 by default. It can be useful when analyzing sparse data from sequence
  based assay or small samples.</p></dd>


<dt>cal_obj</dt>
<dd><p>logical if set as TRUE compute ELBO for convergence monitoring</p></dd>


<dt>quantile_trans</dt>
<dd><p>logical if set as TRUE perform normal quantile transform
on wavelet coefficients</p></dd>


<dt>gridmult</dt>
<dd><p>numeric used to control the number of components used in the mixture prior (see ashr package
for more details). From the ash function:  multiplier by which the default grid values for mixsd differ from one another.
 (Smaller values produce finer grids.). Increasing this value may reduce computational time</p></dd>


<dt>max_step_EM</dt>
<dd><p>see susiF function</p></dd>


<dt>max_SNP_EM</dt>
<dd><p>see susiF function</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Empirical Bayes multivariate functional regression</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephens999/ashr" class="external-link">ashr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘ashr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:fsusieR’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     get_pi0</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">wavethresh</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MASS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> WaveThresh: R wavelet software, release 4.7.2, installed</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Copyright Guy Nason and others 1993-2022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: nlevels has been renamed to nlevelsWT</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Example using curves simulated under the Mixture normal per scale prior</span></span></span>
<span class="r-in"><span><span class="va">rsnr</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#expected root signal noise ratio</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>    <span class="co">#Number of individuals</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fl">10</span>     <span class="co">#Number of covariates/SNP</span></span></span>
<span class="r-in"><span><span class="va">pos1</span> <span class="op">&lt;-</span> <span class="fl">1</span>   <span class="co">#Position of the causal covariate for effect 1</span></span></span>
<span class="r-in"><span><span class="va">pos2</span> <span class="op">&lt;-</span> <span class="fl">5</span>   <span class="co">#Position of the causal covariate for effect 2</span></span></span>
<span class="r-in"><span><span class="va">lev_res</span> <span class="op">&lt;-</span> <span class="fl">7</span><span class="co">#length of the molecular phenotype (2^lev_res)</span></span></span>
<span class="r-in"><span><span class="va">f1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="simu_IBSS_per_level.html">simu_IBSS_per_level</a></span><span class="op">(</span><span class="va">lev_res</span> <span class="op">)</span><span class="op">$</span><span class="va">sim_func</span><span class="co">#first effect</span></span></span>
<span class="r-in"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simu_IBSS_per_level.html">simu_IBSS_per_level</a></span><span class="op">(</span><span class="va">lev_res</span> <span class="op">)</span><span class="op">$</span><span class="va">sim_func</span> <span class="co">#second effect</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">f1</span>, type <span class="op">=</span><span class="st">"l"</span>, ylab<span class="op">=</span><span class="st">"effect"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">f2</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>      y<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>      lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      legend<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effect 1"</span>, <span class="st">"effect 2"</span> <span class="op">)</span>,</span></span>
<span class="r-in"><span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span>,<span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EBmvFR-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, size<span class="op">=</span><span class="va">N</span><span class="op">*</span><span class="va">P</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">N</span>, ncol<span class="op">=</span><span class="va">P</span><span class="op">)</span> <span class="co">#Genotype</span></span></span>
<span class="r-in"><span><span class="va">beta0</span>       <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">beta1</span>       <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">beta2</span>       <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">noisy.data</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">f1_obs</span> <span class="op">&lt;-</span> <span class="va">f1</span></span></span>
<span class="r-in"><span> <span class="va">f2_obs</span> <span class="op">&lt;-</span> <span class="va">f2</span></span></span>
<span class="r-in"><span> <span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>, sd<span class="op">=</span>  <span class="op">(</span><span class="fl">1</span><span class="op">/</span>  <span class="va">rsnr</span> <span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">noisy.data</span> <span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span>   <span class="va">beta1</span><span class="op">*</span><span class="va">G</span><span class="op">[</span><span class="va">i</span>,<span class="va">pos1</span><span class="op">]</span><span class="op">*</span><span class="va">f1_obs</span> <span class="op">+</span> <span class="va">beta2</span><span class="op">*</span><span class="va">G</span><span class="op">[</span><span class="va">i</span>,<span class="va">pos2</span><span class="op">]</span><span class="op">*</span><span class="va">f2_obs</span> <span class="op">+</span> <span class="va">noise</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">noisy.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">noisy.data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">noisy.data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col<span class="op">=</span><span class="op">(</span><span class="va">G</span><span class="op">[</span><span class="fl">1</span>, <span class="va">pos1</span><span class="op">]</span><span class="op">*</span><span class="fl">3</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     main<span class="op">=</span><span class="st">"Observed curves \n colored by the causal effect"</span>, ylim<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span> <span class="va">noisy.data</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col<span class="op">=</span><span class="op">(</span><span class="va">G</span><span class="op">[</span><span class="va">i</span>, <span class="va">pos1</span><span class="op">]</span><span class="op">*</span><span class="fl">3</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>      y<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>      lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      legend<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>,<span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span>,<span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EBmvFR-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">noisy.data</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">G</span></span></span>
<span class="r-in"><span><span class="co">#Running Empirical Bayes multivariate function regression</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">EBmvFR</span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Starting initialization"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Discarding  0 wavelet coefficients out of  128"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Initialization done"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  1 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  2 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  3 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  4 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  5 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  6 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  7 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  8 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  9 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  10 , iter 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  1 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  2 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  3 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  4 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  5 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  6 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  7 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  8 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  9 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  10 , iter 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  1 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  2 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  3 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  4 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  5 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  6 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  7 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  8 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  9 , iter 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fitting effect  10 , iter 3"</span>
<span class="r-in"><span><span class="co">#the easiest way to visualize the result is to use the plot_susiF function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">f1</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Estimated effect 1"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">fitted_func</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'blue'</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>      y<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>      lty<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effect 1"</span>,<span class="st">" EBmvFR est "</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EBmvFR-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">f2</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Estimated effect 2"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">fitted_func</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'green'</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span> <span class="fl">85</span>,</span></span>
<span class="r-in"><span>      y<span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>      lty<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effect 2"</span>,<span class="st">" EBmvFR est "</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"green"</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EBmvFR-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by William R. P. Denault.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

